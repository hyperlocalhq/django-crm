# Django CRM Production Local Settings
# Generated by Ansible - do not edit manually
# Overrides webcrm/settings.py for production deployment

# SECURITY
SECRET_KEY = '{{ django_secret_key }}'
DEBUG = False
ALLOWED_HOSTS = ['{{ domain_name }}', 'www.{{ domain_name }}', '{{ ansible_host }}']

# Database (PostgreSQL)
DATABASES = {
    'default': {
        'ENGINE': '{{ db_engine | default("django.db.backends.postgresql") }}',
        'NAME': '{{ db_name }}',
        'USER': '{{ db_user }}',
        'PASSWORD': '{{ db_password }}',
        'HOST': '{{ db_host | default("localhost") }}',
        'PORT': '{{ db_port | default("5432") }}',
    }
}

# Email Configuration
EMAIL_HOST = '{{ email_host }}'
EMAIL_HOST_USER = '{{ email_host_user }}'
EMAIL_HOST_PASSWORD = '{{ email_host_password }}'
EMAIL_PORT = {{ email_port | default(587) }}
EMAIL_USE_TLS = {{ email_use_tls | default('True') }}
DEFAULT_FROM_EMAIL = '{{ default_from_email | default(email_host_user) }}'
SERVER_EMAIL = '{{ server_email | default(email_host_user) }}'

# Admin emails
ADMINS = [
{% for admin in admins | default([]) %}
    ('{{ admin.name }}', '{{ admin.email }}'),
{% endfor %}
]

# Timezone
TIME_ZONE = '{{ timezone | default("Europe/Berlin") }}'

# Media files (external directory)
MEDIA_ROOT = '{{ media_root }}'

# Security for production
SECURE_HSTS_SECONDS = 31536000
SECURE_HSTS_INCLUDE_SUBDOMAINS = True
SECURE_SSL_REDIRECT = True
SESSION_COOKIE_SECURE = True
CSRF_COOKIE_SECURE = True
SECURE_HSTS_PRELOAD = True

# CRM URL prefixes (change for security)
SECRET_CRM_PREFIX = '{{ secret_crm_prefix | default("crm/") }}'
SECRET_ADMIN_PREFIX = '{{ secret_admin_prefix | default("admin/") }}'
SECRET_LOGIN_PREFIX = '{{ secret_login_prefix | default("login/") }}'

# Server IP
CRM_IP = '{{ ansible_host }}'

{% if google_recaptcha_site_key is defined and google_recaptcha_site_key %}
# reCAPTCHA
GOOGLE_RECAPTCHA_SITE_KEY = '{{ google_recaptcha_site_key }}'
GOOGLE_RECAPTCHA_SECRET_KEY = '{{ google_recaptcha_secret_key }}'
{% endif %}

{% if geoip_enabled | default(false) %}
GEOIP = True
{% endif %}

{% if sentry_dsn is defined and sentry_dsn %}
# Sentry
import sentry_sdk
sentry_sdk.init(dsn="{{ sentry_dsn }}", traces_sample_rate=0.1)
{% endif %}