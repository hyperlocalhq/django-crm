# Django login protection jail configuration
# Protects against brute force login attempts

[django-login]
enabled = true
backend = polling
port = http,https
filter = django-login
logpath = %(nginx_access_log)s
maxretry = 3
findtime = 60
bantime = 3600
banaction = iptables-multiport[name=nginx-login, port="http,https"]
action = %(banaction)s

[django-login-aggressive]
enabled = true
backend = polling
port = http,https
filter = django-login
logpath = %(nginx_access_log)s
maxretry = 10
findtime = 10
bantime = 86400
banaction = iptables-multiport[name=nginx-login-aggressive, port="http,https"]
action = %(banaction)s